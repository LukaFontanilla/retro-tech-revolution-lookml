looker.plugins.visualizations.add({ create: function(element, config) { element.innerHTML = ` <style> .single-value-container { display: flex; justify-content: center; align-items: center; height: 200px; font-size: 4em; font-weight: bold; color: #333; background-color: #f0f0f0; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); } </style> `; this.container = element.appendChild(document.createElement("div")); this.container.className = "single-value-container"; }, updateAsync: function(data, element, config, queryResponse, details, doneRendering) { this.clearErrors(); if (!queryResponse || !queryResponse.fields || !queryResponse.fields.measures || queryResponse.fields.measures.length === 0) { this.addError({title: "No Measures", message: "This visualization requires at least one measure."}); doneRendering(); return; } if (!data || data.length === 0) { this.container.textContent = "No data"; doneRendering(); return; } const firstRow = data[0]; const firstMeasure = queryResponse.fields.measures[0]; const cell = firstRow[firstMeasure.name]; if (!cell) { this.addError({title: "Missing Data", message: `The first measure '${firstMeasure.label_short}' has no data in the first row.`}); doneRendering(); return; } const formattedValue = LookerCharts.Utils.htmlForCell(cell); this.container.innerHTML = formattedValue; doneRendering(); } });
